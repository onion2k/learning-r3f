---
name: Instanced Ducks
menu: Geometries
---

import { Sandbox } from '../../components/Sandbox'

# Instanced ducks

Using instancing to draw a glTF model lots of times

```js
import * as THREE from "three";
import React, { Suspense, useRef } from "react";
import ReactDOM from "react-dom";
import { Canvas, useFrame } from "react-three-fiber";
import { OrbitControls } from "@react-three/drei/OrbitControls";
import { Stats } from "@react-three/drei/Stats";
import Duck from "./duck";
import "./styles.css";
import { Plane } from "@react-three/drei";

const tempDucks = new THREE.Object3D();

const Ducks = ({ i, j }) => {
  const { geometry, material } = Duck();

  const ref = useRef();

  useFrame(({ clock }) => {
    let counter = 0;
    const t = clock.oldTime * 0.001;
    for (let x = 0; x < i; x++) {
      for (let z = 0; z < j; z++) {
        const id = counter++;
        tempDucks.position.set(i / 2 - x, 0, j / 2 - z);
        tempDucks.rotation.y = t;
        tempDucks.updateMatrix();
        ref.current.setMatrixAt(id, tempDucks.matrix);
      }
    }
    ref.current.instanceMatrix.needsUpdate = true;
  });

  return <instancedMesh ref={ref} args={[geometry, material, i * j]} />;
};

const App = () => {
  return (
    <Canvas
      style={{ height: 600, width: 600 }}
      camera={{ position: [0, 1.5, 5] }}
    >
      <pointLight
        position={[5, 5, 0]}
        intensity={1.0}
        distance={25}
        decay={2}
      />
      <Plane args={[50, 50]} rotation={[Math.PI * 1.5, 0, 0]}>
        <meshPhongMaterial color={0x808080} />
      </Plane>
      <Suspense fallback={null}>
        <Ducks i={35} j={35} />
      </Suspense>
      <OrbitControls />
      <Stats />
    </Canvas>
  );
};

ReactDOM.render(<App />, document.getElementById("root"));
```

The duck model is imported from duck.js

```js
/*
Auto-generated by: https://github.com/pmndrs/gltfjsx
GOOGLE_processor_version: 294144208
*/

import { useGLTF } from "@react-three/drei/useGLTF";

export default function Model(props) {
  const { nodes, materials } = useGLTF("/duck/RubberDuck.gltf");
  const duck = nodes["node-0"].geometry.scale(0.1, 0.1, 0.1);
  return {
    material: materials.RubberDuck_mat1,
    geometry: duck
  };
}

useGLTF.preload("/duck/RubberDuck.gltf");
```

### Working example (You can edit this code.)

<Sandbox url="instanced-ducks-os16k" />
